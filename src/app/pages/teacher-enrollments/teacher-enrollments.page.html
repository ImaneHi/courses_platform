<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/teacher-dashboard"></ion-back-button>
    </ion-buttons>
    <ion-title>Enrollments</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <!-- Course Filter -->
  <ion-card *ngIf="course" class="course-info-card">
    <ion-card-header>
      <ion-card-title>{{ course.title }}</ion-card-title>
      <ion-card-subtitle>Course Enrollments</ion-card-subtitle>
    </ion-card-header>
  </ion-card>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="ion-text-center ion-padding">
    <ion-spinner></ion-spinner>
    <p>Loading enrollments...</p>
  </div>

  <!-- Empty State -->
  <ion-card *ngIf="!isLoading && enrollments.length === 0" class="empty-card">
    <ion-card-content class="ion-text-center">
      <ion-icon name="people-outline" size="large" color="medium"></ion-icon>
      <h3>No Enrollments</h3>
      <p *ngIf="course">No students have enrolled in this course yet.</p>
      <p *ngIf="!course">No enrollments found for your courses.</p>
    </ion-card-content>
  </ion-card>

  <!-- Enrollments List -->
  <ion-list *ngIf="!isLoading && enrollments.length > 0">
    <ion-item *ngFor="let enrollment of enrollments" class="enrollment-item">
      <ion-avatar slot="start">
        <img [src]="'https://ui-avatars.com/api/?name=' + (enrollment.studentId || 'Student')" />
      </ion-avatar>

      <ion-label>
        <h2>Student ID: {{ enrollment.studentId }}</h2>
        <p>Enrolled: {{ getEnrollmentDate(enrollment) }}</p>
        <ion-badge [color]="getEnrollmentStatusColor(enrollment.status || 'active')">
          {{ enrollment.status || 'active' | titlecase }}
        </ion-badge>
      </ion-label>

      <ion-button slot="end" fill="clear" [routerLink]="['/course', enrollment.courseId]">
        <ion-icon name="eye-outline"></ion-icon>
      </ion-button>
    </ion-item>
  </ion-list>

  <!-- Summary -->
  <ion-card *ngIf="!isLoading && enrollments.length > 0" class="summary-card">
    <ion-card-header>
      <ion-card-title>Summary</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-grid>
        <ion-row>
          <ion-col size="4">
            <div class="summary-item">
              <h2>{{ enrollments.length }}</h2>
              <p>Total</p>
            </div>
          </ion-col>
          <ion-col size="4">
            <div class="summary-item">
              <h2>{{ getActiveEnrollmentsCount() }}</h2>
              <p>Active</p>
            </div>
          </ion-col>
          <ion-col size="4">
            <div class="summary-item">
              <h2>{{ getCompletedEnrollmentsCount() }}</h2>
              <p>Completed</p>
            </div>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-card-content>
  </ion-card>
</ion-content>

